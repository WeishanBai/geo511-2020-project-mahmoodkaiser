---
title: "Vehicle Towing in Buffalo"
author: Kaiser Mahmood
subtitle: Analysis in R
---

# Introduction

Towing of vehicles is a huge problem and there may be a lot of factor that could influence towing. In this project I tried to explore the towing data in buffalo to figure out any potential spatial relation of towing with location, and roadway and demographic characteristics.

# Materials and methods

You can do numbers like this:

1. Getting associated data
2. Data cleaning
3. Getting Spatial map


Load any required packages in a code chunk (you may need to install some packages):

```{r, message=F, warning=F}
library(ggplot2)
library(tidyverse)
library(dplyr)
library(tidyr)
library(lubridate)
library(leaflet)
library(ggmap)
library(sf)
library(sp)
library(kableExtra)
```

## Download and clean all required data
```{r, message=F, warning=F}
data=read_csv("https://data.buffalony.gov/api/views/5c88-nfii/rows.csv?accessType=DOWNLOAD")

data2 <- separate(data, col = `TOW DATE`, into = c("Month","Date", "Year"), sep = "/") %>%
  select(Month, Date, Year,`TOW DESCRIPTION`, LATITUDE, LONGITUDE, `POLICE DISTRICT`) %>%
  filter(LONGITUDE!="NA"|LATITUDE!="NA")

data2 %>% 
  slice(1:10) %>% #show only 1:n rows
  kable(digits=2,align="c")%>% #make table and round to two digits
  kable_styling(bootstrap_options = 
                  c("striped", "hover", "condensed", "responsive")) #apply other formatting

tow_reason <- data2 %>% group_by(`TOW DESCRIPTION`) %>% summarize(count=n())
tow_reason
Police_district <- data2 %>% group_by(`POLICE DISTRICT`) %>% summarize(count=n())
Police_district
year_count <- data2 %>% group_by(Year) %>% summarize(count=n())
ggplot(year_count,aes(Year, count)) + geom_col()

```


```{r project plot}
plot1 <- ggplot(data,aes(LONGITUDE,LATITUDE,col=`TOW DESCRIPTION`))+geom_point()
plot1
```



# Results
Transform the data to the spatial data prepared for the interactive map.

```{r}
new_data <- data %>% filter(LONGITUDE!="NA"|LATITUDE!="NA")
m <- leaflet(new_data) %>% 
   addTiles() %>% 
   setView( lng = -78.9, lat = 42.9, zoom = 11 ) %>% 
   addCircleMarkers(lng = ~LONGITUDE,
                    lat = ~LATITUDE,
                    clusterOptions = markerClusterOptions())%>%
   #addProviderTiles("Esri.WorldImagery")
   addProviderTiles("Esri.WorldTopoMap")
   #addProviderTiles("NASAGIBS.ViirsEarthAtNight2012")
m
```
Add any additional processing steps here.




# Conclusions



# References


